{% extends 'inventory/base.html' %}
{% block title %}Dashboard Overview{% endblock %}

{% block content %}

    <style>
        /* Emerald Gradient (Replaces Sharp Green) */
        .card-gradient-teal { background: linear-gradient(135deg, #10b981, #059669); }
        
        /* Rose Gradient (Replaces Sharp Red) */
        .card-gradient-rose { background: linear-gradient(135deg, #f43f5e, #e11d48); }
        
        /* Royal Blue (Kept as is, it's nice) */
        .card-gradient-blue { background: linear-gradient(135deg, #3b82f6, #2563eb); }
        
        /* Slate (Dark) */
        .card-gradient-dark { background: linear-gradient(135deg, #64748b, #475569); }
        
        .stat-card {
            border: none;
            border-radius: 16px;
            color: white;
            box-shadow: 0 10px 20px -5px rgba(0, 0, 0, 0.15);
            transition: transform 0.2s ease;
        }
        .stat-card:hover { transform: translateY(-5px); }
        
        .icon-box {
            background: rgba(255, 255, 255, 0.2);
            width: 50px; height: 50px;
            border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
        }
    </style>

    <div class="row mb-5">
        <div class="col-md-3">
            <div class="card stat-card card-gradient-teal h-100 p-3">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="text-white-50 text-uppercase small fw-bold mb-1">Total In</h6>
                        <h2 class="fw-bold mb-0">{{ total_in }}</h2>
                        <small class="text-white-50" style="font-size: 11px;">Bags Deposited</small>
                    </div>
                    <div class="icon-box"><i class="bi bi-arrow-down-circle-fill fs-3 text-white"></i></div>
                </div>
            </div>
        </div>
        
        <div class="col-md-3">
            <div class="card stat-card card-gradient-rose h-100 p-3">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="text-white-50 text-uppercase small fw-bold mb-1">Total Out</h6>
                        <h2 class="fw-bold mb-0">{{ total_out }}</h2>
                        <small class="text-white-50" style="font-size: 11px;">Bags Dispatched</small>
                    </div>
                    <div class="icon-box"><i class="bi bi-truck-front-fill fs-3 text-white"></i></div>
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="card stat-card card-gradient-blue h-100 p-3">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="text-white-50 text-uppercase small fw-bold mb-1">Net Stock</h6>
                        <h2 class="fw-bold mb-0">{{ net_stock }}</h2>
                        <small class="text-white-50" style="font-size: 11px;">Bags Available</small>
                    </div>
                    <div class="icon-box"><i class="bi bi-box-seam-fill fs-3 text-white"></i></div>
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="card stat-card card-gradient-dark h-100 p-3">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="text-white-50 text-uppercase small fw-bold mb-1">Today</h6>
                        <h4 class="fw-bold mb-0">{% now "d M Y" %}</h4>
                        <small class="text-white-50" style="font-size: 11px;">Active Session</small>
                    </div>
                    <div class="icon-box"><i class="bi bi-calendar-event-fill fs-3 text-white"></i></div>
                </div>
            </div>
        </div>
    </div>

    <div class="card border-0 shadow-sm mb-5 rounded-4 overflow-hidden">
        <div class="card-header bg-white pt-4 px-4 border-bottom-0 d-flex align-items-center">
            <div class="p-2 rounded-circle me-3" style="background-color: #d1fae5; color: #059669;">
                <i class="bi bi-arrow-down-circle-fill fs-5"></i>
            </div>
            <div>
                <h5 class="fw-bold text-dark mb-0">Recent Deposits (SR)</h5>
            </div>
        </div>
        
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-hover align-middle mb-0" style="font-size: 13px;">
                    <thead class="bg-light text-secondary text-uppercase fw-bold" style="font-size: 11px;">
                        <tr><th class="ps-4 py-3">Date</th><th>District</th><th>Commodity</th><th>Godown</th><th>Quantity</th><th>Actions</th></tr>
                    </thead>
                    <tbody>
                        {% for t in recents %}
                            {% if t.type == 'SR' %}
                            <tr>
                                <td class="ps-4 fw-bold text-secondary">{{ t.date|date:"d M" }}</td>
                                <td><div class="fw-bold text-dark">{{ t.district }}</div><small class="text-muted">{{ t.branch }}</small></td>
                                <td>
                                    <span class="badge rounded-pill" style="background-color: #d1fae5; color: #059669; border: 1px solid #a7f3d0;">
                                        {{ t.crop.name }}
                                    </span>
                                </td>
                                <td>{{ t.godown.name }}</td>
                                <td class="fw-bold" style="color: #059669;">+{{ t.bags }}</td>
                                <td>
                                    <a href="{% url 'edit_transaction' t.id %}" class="btn btn-sm btn-light text-primary"><i class="bi bi-pencil-fill"></i></a>
                                    <a href="{% url 'print_receipt' t.id %}" target="_blank" class="btn btn-sm btn-light text-dark"><i class="bi bi-printer-fill"></i></a>
                                </td>
                            </tr>
                            {% endif %}
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="card border-0 shadow-sm mb-4 rounded-4 overflow-hidden">
        <div class="card-header bg-white pt-4 px-4 border-bottom-0 d-flex align-items-center">
            <div class="p-2 rounded-circle me-3" style="background-color: #ffe4e6; color: #e11d48;">
                <i class="bi bi-truck-front-fill fs-5"></i>
            </div>
            <div>
                <h5 class="fw-bold text-dark mb-0">Recent Dispatch (DL)</h5>
            </div>
        </div>

        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-hover align-middle mb-0" style="font-size: 13px;">
                    <thead class="bg-light text-secondary text-uppercase fw-bold" style="font-size: 11px;">
                        <tr><th class="ps-4 py-3">Date</th><th>Party</th><th>Commodity</th><th>Godown</th><th>Quantity</th><th>Actions</th></tr>
                    </thead>
                    <tbody>
                        {% for t in recents %}
                            {% if t.type == 'DL' %}
                            <tr>
                                <td class="ps-4 fw-bold text-secondary">{{ t.date|date:"d M" }}</td>
                                <td><div class="fw-bold text-dark">{{ t.party_name }}</div></td>
                                <td>
                                    <span class="badge rounded-pill" style="background-color: #ffe4e6; color: #e11d48; border: 1px solid #fecdd3;">
                                        {{ t.crop.name }}
                                    </span>
                                </td>
                                <td>{{ t.godown.name }}</td>
                                <td class="fw-bold" style="color: #e11d48;">-{{ t.bags }}</td>
                                <td>
                                    <a href="{% url 'edit_transaction' t.id %}" class="btn btn-sm btn-light text-primary"><i class="bi bi-pencil-fill"></i></a>
                                    <a href="{% url 'print_receipt' t.id %}" target="_blank" class="btn btn-sm btn-light text-dark"><i class="bi bi-printer-fill"></i></a>
                                </td>
                            </tr>
                            {% endif %}
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

{% endblock %}